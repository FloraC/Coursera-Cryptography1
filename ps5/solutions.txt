--------------------------------------------------------------------------------
1.

First, Alice contacts the TTP.  At minimum, she must receive from the server
the shared key encrypted with her own private key, or E(k_a, k_abc).

She must also not send the shared key in the clear.  Therefore the TTP should
send Alice
_
E(k_a, k_abc), ticket1 <- E(k_b, k_abc), ticket2 <- E(k_c, k_abc)
Alice sends ticket1 to Bob and ticket2 to Carol
_

--------------------------------------------------------------------------------
2.

> f := g^(x+y)
This function _is not difficult to compute_. Specifically, an attacker can
compute f by simply computing g^x * g^y = g^(x+y).

> f := g^(x-y)
This function _is not difficult to compute_. Specifically, an attacker can
compute f by simply computing g^x/g^y = g^(x-y).

> f := g^(xy + x + y + 1)
This function _is difficult to compute_.  Suppose an attacker can compute f.
He could then compute DH with the equation
DH(g^x, g^y) = g^xy = f(g^x, g^y)/(g * g^x * g^y)

> f := g^2xy
This function _is difficult to compute_.  Suppose an attacker can compute f.
He could then compute DH with the equation

DH(g^x, g^y) = g^xy = sqrt_p(f(g^x, g^y))
Where sqrt is the square root modulo p, which is "easy" for a finite cyclic
group Z_p

--------------------------------------------------------------------------------
3.

Since Bob sends Alice g^(1/b), she has no way of computing g^ab.  The secret
key must therefore be g^(a/b).  They generate this key as B^a and A^(1/b).  In
other words:

_secret = g^(a/b).  Alice computes the secret as B^a and Bob computes A^(1/b).

--------------------------------------------------------------------------------
4.

The additional step _does not_ prevent the MitM attack.  An attacker can
intercept the initial message from Alice to Bob, and replace pk with pk'.  He
sends pk' to Bob, who responds with (E(pk', x), S(x, E(pk', x)).  The attacker
then decrypts E(pk', x) to determine x, computes E(pk, x), and sends
(E(pk,x),S(x,E(pk,x)) to Alice.  Alice sees that the MAC is correct and
communicates insecurely with Bob.

--------------------------------------------------------------------------------
5.

Using some simple python, we see that (a,b) = (10,-3)

In Z_23, 7a + 23b = 7a and 1 = 1.
So 7a = or _a^-1 = 10_

--------------------------------------------------------------------------------
6.


--------------------------------------------------------------------------------
7.


--------------------------------------------------------------------------------
8.


--------------------------------------------------------------------------------
9.


--------------------------------------------------------------------------------
10.


--------------------------------------------------------------------------------
